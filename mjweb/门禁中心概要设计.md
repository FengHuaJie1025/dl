## 一、引言

### 1.1 概要简述

概要设计是用来评价软件整体设计可行性的重要支撑标准，由于每个模块这个阶段已经开始确定，可以很好的检查已有的模块是否已经足够完整，还可以用于评估工作量以及知道下一步的主要计划，这里用合力的具体实现来展示项目的具体业务流程，它是一个纲领。

### 1.2 编写目的

本概要设计文档主要用来指导门禁管理平台的详细设计工作，为详细设计提供统一的参照标准，其中包括系统的总体设计、内外部接口、系统架构、编程模型以及其他各种主要问题的解决方案。

在此文档被经过同行评审后，所有有关本系统的详细设计必须遵照此文档的相关标准和约束来进行。另外，此文档也作为对详细设计文档进行同行评审所依照的标准之一。

在详细设计的过程中，如果发现需要添加新的概要设计标准或者约束来指导详细设计工作，必须在此文档进行更新和评审，以确保各模块详细设计的一致性和正确性。

本文档主要描述的是创新综合管理系统的概要设计，其中包括定义系统的内外部接口、相关的系统架构和设计标准，不会涉及系统业务逻辑现实的细节。

在对用户进行需求调研的基础上，根据需求分析说明书编写了本概要设计，以作为详细设计及系统实现的依据。本文主要阅读对象为相关技术人员和项目责任人。

### 1.3 背景



## 二、总体设计

### 2.1 设计前提和约束条件

1. 
2. 
3. 

### 2.2 基本设计思想



**（1）数据问题：**



**（2）信息模型：**



**（3）功能实现：**



### 2.3 系统整体结构设计

 ![功能结构图](./static/功能结构图.png)

### 2.4 物理部署关系图

物理部署图如下：

![img](http://image.woshipm.com/wp-files/2019/07/VKwd7buFzomTJqcLyUdX.jpg)

### 2.5 平台应用技术路线

平台技术路线图如下：

![img](http://image.woshipm.com/wp-files/2019/07/C0Ktg0IBAT9ig4PEReLH.png)

### 2.6 需求规定

- 网站内容建设：
- 安全系统建设：
- 硬件与系统软件建设：

**2.6.1 服务器配置要求**

服务器系统平台建设要依据实用、先进、可靠、高效、易用、安全、可扩展原则，以满足大量用户上网使用服务的要求。

服务器要具有强大的处理能力、快速的磁盘访问和高可靠性、高可用性的特点；同时服务器的体系结构要符合开放性的标准，具有可扩充性，最大范围地支持业界各种优秀的操作系统和服务软件，充分满足持续快速的业务发展需要。

主要服务器设备为：

- WEB服务器：Web服务器提供HTTP服务，是用户访问的接入口，是构造网站群应用的基础，本工程要求设置两台Web服务器，利用Web服务器软件的负载均衡功能，保证不间断对外服务。
- 数据库服务器：数据库服务器是应用系统中所有数据资源的管理中心。
- 应用服务器：应用服务器提供网站应用逻辑和动态服务栏目的功能处理，应用系统对服务器处理速度、内存、存储容量等方面有较高要求。
- 其它服务器：运行网站后台内容管理服务、跨网站检索服务、访问统计分析服务、视频点播服务、网络防病毒服务和网页防篡改发布服务等。



[linux查看硬件信息命令](https://www.cnblogs.com/cloudos/p/8416415.html)

服务器和存储系统配置表如下：

| 序号 | 设备                                                         | 性能                                                         | 数量 | 用途                                                 |
| ---- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---- | ---------------------------------------------------- |
| 1    | 服务器（含web服务器、数据库服务器、GIS服务器及数据接口服务器 | CPU： 4  Intel(R) Xeon(R) CPU E5-2680 v3 @ 2.50GHz<br />内存：16GB<br />硬盘：60GB | 1台  | 用于业务功能的硬件承载，保证系统的正常运行           |
| 2    | 磁盘阵列                                                     | 双存储处理器，每处理8G内存，支持30块300G15K转光纤磁盘。支持EFD、FC、SATA磁盘。 | 1台  | 用于存放全生命周期内所有信息数据，以及保证数据的安全 |
| 3    | 防火墙                                                       | 48千兆网络端口，背板处理能力176Gbps，每秒分组数74.4Mbps      | 1台  | 用于系统的安全防护，对平台与网络用户之间的数据防护。 |



**2.6.2 网络安全建设要求**

网络安全的建设目标要求针对网络在将来实际运行过程中可能遇到的各种安全威胁，采用防护、检测、反应、恢复四方面行之有效的安全措施，建立一个全方位并易于管理的安全体系，保障网络能够安全、稳定、可靠地运行，需要制定出安全体系的具体目标，以保证安全系统工程的实施。

主要体现：

- 提高可靠性：通过冗余措施加以保证，具体包括线路冗余、设备备份措施。
- 防范与Internet互联的安全威胁：在外网与Internet互连区采用安全可靠的防火墙。
- 采用防病毒措施：在两个方面防范。一方面建立完整的网络防毒机制，另一方面建立严格完善的防毒管理规范。
- 防范网络服务的安全威胁：确保必须的网络服务的安全和可靠性。如DNS；对其它网络基本服务，限制使用范围，建立严格的使用管理规定，防止被黑客利用，绝对禁止匿名FTP服务，对需要使用又必须保证安全的场合，要经过身份认证、访问授权和审计记录机制的控制。
- 阻止黑客攻击：在两个方面防护。一方面在Internet互联区域及与内网互连区域设置防火墙。另一方面采用防黑客攻击软件：1）实现安全漏洞的扫描，结合系统管理及时修补安全漏洞；2）提供网络实时入侵检测，在一定程度上实现对内网与外网的入侵阻隔；3）做好攻击的跟踪审计。
- 保障网站内容安全：防止网站数据被非法篡改，并且在被篡改后能及时恢复。

**2.6.3 平台建设目标**

4. 

### 2.7 运行环境

| 类别     | PC端              | 手机客户端   |
| -------- | ----------------- | ------------ |
| 处理器   | I7-9750H          | 骁龙855      |
| 内存     | 16GB              | 8GB          |
| 硬盘     | 256GB SSD+1TB HDD | 256GB ufs3.0 |
| 网络配置 | 千兆网络          | 移动4G       |
| 操作系统 | win10             | Android10    |
| 客户端   | chrome            | chrome       |



### 2.8 开发环境

- 开发系统：win10
- 开发环境：idea2019
- 开发语言：Java8
- 数据库：Mysql

软件需求表如下：

![img](http://image.woshipm.com/wp-files/2019/07/iNGh4wnK6Vda48vQaDKO.png)

### 2.9 性能要求

**2.9.1 处理能力**

系统面对多用户任务并发性，应保证正常的处理运行能力。

**2.9.2 稳定性**

系统资源利用合理，保证系统前后台数据操作效率。

**2.9.3 传输能力**

本系统业务功能包括附件和图片传输，应提高文件传输速度。

**2.9.4 管理能力**

有序的对信息内容和模块进行合理的管理。

### 2.10 基本设计概念和处理流程

**2.10.1 平台结构**

系统的操作界面完全基于浏览器，程序服务系统划分为三种组件，模型 – 视图 – 控制器（MVC）设计定义它们之间的相互作用。

平台结构层次图如下：

![img](http://image.woshipm.com/wp-files/2019/07/VciajyqRzIxPIikUaSBL.png)

系统具有良好的跨平台性，系统采用基于开发语言的一系列标准，使本系统可在各种硬件平台、操作系统、Web Server平台上进行方便的移植。

**模型（Model）**用于封装与应用程序的业务逻辑相关的数据以及对数据的处理方法。“Model”有对数据直接访问的权力，例如对数据库的访问。“Model”不依赖“View”和“Controller”——也就是说，Model 不关心它会被如何显示或是如何被操作。但是 Model 中数据的变化一般会通过一种刷新机制被公布。为了实现这种机制，那些用于监视此 Model 的 View 必须事先在此 Model 上注册，从而，View 可以了解在数据 Model 上发生的改变。

**视图（View）**能够实现数据有目的的显示（理论上，这不是必需的）。在 View 中一般没有程序上的逻辑。为了实现 View 上的刷新功能，View 需要访问它监视的数据模型（Model），因此应该事先在被它监视的数据那里注册。

**控制器（Controller）**起到不同层面间的组织作用，用于控制应用程序的流程。它处理事件并作出响应。“事件”包括用户的行为和数据 Model 上的改变。

**2.10.2 系统软件设计模式的基本描述**

1. 客户在登录界面，输入操作员号，密码后，提交。
2. 客户有效性检查：客户密码有效性检查，客户状态检查。
3. 根据客户端提供的客户名称、口令，取出对应的加密后的口令，检查客户口令的正确性
4. 若客户登录不合法，则返回客户登录不成功界面
5. 若客户登录合法，进入客户登录后界面生成模块
6. 进入客户登录后界面，组织并生成客户登录后页面
7. 根据客户在页面上的操作分别进入不同处理流程
8. 客户点击具有下级菜单的菜单条目，则再进入客户登录后界面生成模块产生下级业务菜单界面。
9. 客户点击通知信息条目，则在新窗口显示此通知信息内容
10. 客户点击指向业务处理的菜单条目，则再进入客户选择业务列表界面，界面中显示客户所选菜单的经办行业务列表。若该业务不存在业务列表，则立即进入相应的业务处理流程。
11. 客户点击通知业务快捷键，直接进入该业务的业务列表界面或相应业务处理流程。客户点击业务列表中的业务条目，则进入相应业务处理流程。

**2.10.3 模块的标准流程**

模块标准流程图如下：

![img](http://image.woshipm.com/wp-files/2019/07/MlGaWJokKWUvEDlASwMx.png)

### 2.11 平台技术架构

平台开发采用B/S架构，集成多种异构系统，结合代码协同工具Git，帮助研发人员完成协作开发，使用自动化运维工具，简化部署发布流程；

平台技术架构图：

![img](http://image.woshipm.com/wp-files/2019/07/Ui8IP3uCeMxBGBFjgEmi.png)

### 2.12 功能需求与程序的关系

**2.12.1 概述**

网站群的应用系统功能主要分为三大类，网站前台发布展现功能、网站内容管理功能、网站其它应用系统后台管理功能。

- 网站前台发布展现功能主要提供给Internet用户，一般是网站浏览者，网站注册用户（个人和企业用户）。
- 网站内容管理功能、网站其它应用系统后台管理功能主要提供给系统管理员、网站管理员及相关单位网站信息管理员等。

**2.12.2 分配关系**

网站群主要功能模块与网站群应用系统的矩阵关系如下：

![img](http://image.woshipm.com/wp-files/2019/07/ALToYwSqsDgBX5CGoCzr.png)

交互功能栏目包括：栏目维护、用户注册、用户登录。

其它应用子系统：站群检索系统、信息采集系统、视频点播系统、访问统计分析系统。

### 2.13 关键技术要点

**2.13.1 多元异构模型融合**

将BIM模型导入GIS场景时，读取BIM模型的坐标系信息，自动计算与GIS坐标系的转换公式，并依据公式将BIM模型的所有坐标转换为GIS投影坐标，完成GIS与BIM的集成。针对Revit模型、GIS数据、测绘院模型等，通过分析格式之间的差异，在保证模型信息不丢失的前提下，基于格式扩展与转换技术，实现多模型无缝融合。

BIM与GIS应用领域的不同导致其具有不同的数据标准，数据模型上两者采用了不同的对象几何表达方式和语义描述方法。

前者是针对建筑设计和分析应用的几何表达，具有丰富的建筑构造、建筑设施的几何语义信息；后者更加强调对空间对象的多尺度表达，并顾及对象几何、拓扑和语义表达的一致性。

在几何表达方面，BIM模型通常采用的表达方式有三种：

边界表示法（B-rep），扫描体以及构造实体几何模型（CSG）。

在边界模型中，通过多个组成面拼接来呈现整个模型。扫描体是通过将平面对象沿路径拉伸或者绕轴旋转拉伸而得到。

结构实体几何模型（CSG）通常是通过将立方体、球体、圆柱体、圆锥体等基本体素作为基元实体类型，然后通过对这些基本实体进行几何变换、布尔运算以及剖割、局部修改等操作形成更加复杂的几何实体。而GIS中的三维几何主要采用边界表示法。

在语义信息表达上，从宏观上GIS模型包含有多尺度的语义描述，而BIM模型虽然具有丰富的语义信息却不具有多尺度表达的特点。

具体来讲，BIM模型包含有大量的建筑物细节描述，包括构件语义信息和部件间的语义连接关系，而GIS中语义信息采用多细节层次表达（LOD）技术，如CityGML标准将三维对象的精细程度分为五个细节层次。

LOD0在本质上就是2.5维的数字地形图，表达了建筑物的底面平面和屋顶平面；LOD1表达了平屋顶的棱状建筑，为块模型；LOD2表达了有分化的建筑物屋顶及其附属结构；LOD3在此基础上增加了墙体、屋顶、凹陷和突出部分等外观信息的细节性描述，可以将高分辨率的纹理映射到这些结构中；LOD4在LOD3的基础上增加了对内部结构的描述，如房间，内部门，楼梯和家具等，具有详细的几何和语义信息表达。

在BIM与GIS集成的过程中，数据模型的一致性转换成为当下急需解决的问题，Revit模型中包含了丰富的几何信息和语义信息；然而，在GIS系统中，不同的应用对数据模型的详细程度要求不一致，所以在数据转换的过程中，需要针对不同的应用需求进行相应的转换，涉及到几何简化，语义映射及语义输出的问题。

整体数据转换思路如下图所示：

整体转换流程图：

![img](http://image.woshipm.com/wp-files/2019/07/GDuqAcryvmEUwYoNh6Zk.png)

首先，获取模型语义信息，Revit模型中定义了从建筑、结构到暖通、机械、电气，管道等室内外建筑元素的语义类别信息。除此之外，每种建筑元素都包含有特定的属性信息，如建筑墙体会有是否为承重墙等标识属性。

其次，以这些类语义信息作为约束条件，构建过滤器，获取构件元素实体的几何信息和属性信息，并通过元素的ID标识将属性和几何信息关联。

最后，提取材质信息，Revit模型单独定义了材质元素，可以通过构建材质过滤器的方式，获取实际模型中所用的所有材质信息，并通过材质的ID标识和几何信息中相应材质关联起来。

Revit模型中包含了丰富的语义信息，涉及到建筑设计、建筑结构工程设计和暖通、电气、给排水工程设计等众多建筑学领域。选取Revit中常用的建筑元素，按照建筑、结构、管道和卫浴、机械设备、暖通（HVAC）等进行分块，定义了从室外到室内各类型建筑构件，见表1所列。

可根据GIS中不同LOD的表达需要，做相应的语义信息映射。

除此之外，RVT模型中还包含了建筑元素的建造阶段、拆除阶段、防火等级，成本，功能、制造商、结构用途以及物理性能等属性信息。

RVT模型中常用构建类别表如下：

![img](http://image.woshipm.com/wp-files/2019/07/IFP59w8hnY5N583yCjVz.png)

**2.13.2 网络环境下的模型轻量化浏览**

对数据自动分层分块，内部用bsp树组织场景，客户端按需要请求必要的数据，保证每次请求的数据量不会太大，加快客户端加载速度。数据下载与模型渲染采用多线程方式并行处理，但模型渲染的优先级高，从而保证用户在浏览操作时不会因为数据下载而卡顿。数据下载模块同样采用多线程技术，同时采用异步机制，利用下载队列进行数据下载管理。

（1）模型优化

BIM模型数据内部存在很多冗余数据或者不必要的点面，导致数据量非常庞大。平台在进行BIM数据处理时，增加了多种优化数据选项供用户选择，包括：构件按族、类型、类别合并；构件自动生成LOD数据；抽取关键点坐标重构构件；平滑组优化等。

（2）渲染优化

① LOD技术：

能根据用户视角自动对模型简化生成不同精度的模型，从而对于距离摄像机比较远的模型采用其对应的粗模，这样就能保证用户体验效果的情况下大大减少了提交给显卡的数据量，减小了系统的渲染压力，提高了系统渲染速度。

② 多种场景剔除技术：

- 层剔除按摄像机在不同高度对相应的图层模型进行剔除；
- 投影面积剔除则是针对非常小的模型肉眼几乎无法识别的时候做隐藏处理；
- 子场景剔除可通过设定子场景范围，当摄像机位于子场景之外时，将子场景内部的模型做剔除处理。一般适用于包含室内场景及室外场景的场合。

③ 内存动态合并技术：

三维展现的基本机制是将三维模型数据提交给显卡，由显卡进行绘制渲染。由于显卡显存与计算机总线进行数据交换的数据通道宽度有限，过多的模型个数会造成数据通道的阻塞，形成IO瓶颈。

Q-MAP引擎采用内存动态合并的技术，将模型文件中的多个构件在内存中自动合并成一个模型，一次性推送给显卡，从而降低的渲染的批次，在不提升硬件水平的情况下提升展示的流畅度，同时又不影响对单个构件的查询定位。

### 2.14 需要人工处理过程

各种表单填制等需要填制的信息。

数据权限和功能权限需要管理员进行人工操作。

## 三、安全设计

### 3.1 系统安全体系

系统的安全体系可用下图表示：

![img](http://image.woshipm.com/wp-files/2019/07/aLVg4xLnXrMJ7UWZdLvn.png)

整个系统的安全取决于系统运行物理环境的安全性、服务器及网络的安全性、操作系统的安全性、应用系统的安全性及应用数据的安全性等，通过设计实施整体的安全策略，对安全策略的实施结果进行评估，及时采取修复补救措施，调整安全预防策略，综合动态地进行系统安全管理。

创新综合管理系统的信息数据安全主要实现在业务流程控制和代码的详细设计中，对系统权限设计应充分考虑整体策略安全性。

由于本系统建立在我行现有的物理环境和网络环境中，环境安全性很好，并将不断完善优化，因此，有关本系统的安全设计的主要对象是系统自身的应用安全、数据安全、服务器操作系统和数据库的安全管理维护。

### 3.2 系统面临的安全威胁

本系统需要考虑系统及数据可能面临的以下安全威胁：

- 非人为因素：服务器意外断电、损坏、硬盘出错或损坏，网络中断等；
- 人为因素：操作失误，恶意攻击，病毒破坏等；
- 信息泄露、信息窃取、假冒、抵赖等；
- 系统软件安全漏洞。

### 3.3 访问控制

对于网络资源保持有限访问的原则，信息流向可根据安全需求实现单向或双向控制。采用防火墙进行访问控制，安置在不同安全区域出入口，对进出网络的IP信息包进行过滤并按设定的安全策略进行信息流控制。

### 3.4 容错机制

利用RAID提供的磁盘存储产品，可以在硬盘故障的情况下不影响数据的有效和使用。

采用RAID（0+1）模式，利用RAID1的数据镜像实现数据冗余，同时与RAID0一起增加数据读取速度。

### 3.5 系统安全方案

针对上述安全威胁，系统的安全运行依赖网络和服务器系统的安全，系统本身需要设计相应的安全监控功能。

### 3.6 服务器及客户端系统安全

对于数据库系统，进行相应的安全配置维护管理，根据实际情况及时进行安全策略调整，定期进行数据库系统的有关备份。

由于客户端计算机用途很开放，很容易受到病毒感染、恶意攻击等，可能会进一步影响到服务器，因此，对客户端计算机也要采取安全措施，进行相应的安全配置管理，如设置有效的系统密码，设置较高的浏览器级别，及时打补丁，安装反病毒程序，定期查杀病毒，根据实际情况及时采取安全措施。

### 3.7 应用系统安全

**3.7.1 用户系统**

该平台拥有灵活的用户体系，根据项目的实际需求，可创建不同的用户多用户角色，同时该角色可分配相应的操作权限。

用户登录方式图如下：

![img](http://image.woshipm.com/wp-files/2019/07/Los22CCewvCFQjzVV89i.png)

默认在微信中打开系统首页，通过微信授权后，初次授权系统默认为该用户创建账号，并填写相应的基本信息供管理审核。

**3.7.2 权限系统**

权限系统一直以来是我们应用系统不可缺少的一个部分，若每个应用系统都重新对系统的权限进行设计，以满足不同系统用户的需求，将会浪费我们不少宝贵时间，所以花时间来设计一个相对通用的权限系统是很有意义的。

本系统的设计目标是对应用系统的所有资源进行权限控制，比如应用系统的功能菜单、各个界面的按钮控件等进行权限的操控。

权限颗粒、节点权限、模块入口权限、添加、删除、修改。

### 3.8 服务器设备配置规划

**3.8.1 需求规定**

XXXX管理平台主要为阿里云服务器。

**3.8.2 服务配置表**

![img](http://image.woshipm.com/wp-files/2019/07/qz311t4ed8ey0rHgE33Q.png)

**3.8.3 部署配置说明**

![img](http://image.woshipm.com/wp-files/2019/07/ZNjfDLN2OWMHIQDlTG16.png)

### 3.9 网络安全设置

**3.9.1 需求规定**

Internet 是自由开放的信息载体，对于网站群的建设不可避免的带来信息安全隐患。如果不设安全保护系统，Internet上的黑客很容易利用已存在的网络漏洞攻击系统内网的服务器，Internet上的病毒也会伺机入侵网站系统。

为了彻底解决网站群的安全性，确保其内网敏感信息不被泄漏、删除及篡改，要求网站群整体部署入侵防御系统、漏洞扫描系统、综合过滤网关系统、防病毒系统、网页防篡改及网站恢复系统，并制订相应的安全策略设计,在实际运行中最大程度上杜绝Internet带来的安全风险。

**3.9.2 网络安全规划设计**

3.9.2.1 综合过滤网关

综合过滤网关的连接方式如下图所示，安装在网络中心互联网出口，防火墙之后。采用透明模式，需要分配一个内网的管理地址进行管理配置，GE_1口上连H3C防火墙，GE_2口下连IPS的GE_1口，管理端口连接在H3C核心交换机上。

![img](http://image.woshipm.com/wp-files/2019/07/ZKnLVUNCwI9nBtRiaUYi.png)

综合过滤网关实现以下主要功能：

1. 防病毒引擎。过滤网关采用自有防病毒引擎，以保证防病毒网关在使用过程中病毒库、蠕虫库等的可持续性升级和病毒库数量和质量的持续保障。
2. 病毒过滤。全面过滤网页访问（http）、文件下载（ftp）、电子邮件（smtp、pop3）等形式的病毒和恶意代码，智能识别处理可疑病毒和伪装形式病毒，防止多种传播方式的病毒入侵破坏。
3. 蠕虫过滤。可以实现蠕虫过滤（过滤静态蠕虫扩散、阻断蠕虫动态攻击）。为修复漏洞和改进网络安全状况赢得宝贵时间。
4. 垃圾邮件过滤。通过垃圾邮件特征分析、规则库、黑白名单等技术，全面实现垃圾邮件双向过滤。
5. 非法内容过滤。通过关键字识别方法，对邮件头、正文、附件进行内容过滤，并支持URL过滤和网页脚本过滤。
6. 网络防御保护。可根据IP地址、端口、协议、连接频率和速率等对网络数据包进行控制，防止非法的网络访问活动。
7. 自动更新。根据预定义的更新频率与策略，可通过Internet自动实时更新特征码，并可实现系统内核的在线升级。

3.9.2.2 入侵防御系统

入侵防御系统的连接方式如上图（网络安全设备连接图）所示，安装在网络中心的互联网出口，过滤网关之后。采用透明模式，需要分配一个内网的管理地址进行管理配置，GE_1口上连过滤网关的GE_2口，GE_2口下连光电转换器的千兆电口，管理端口连接在H3C核心交换机上。

![img](http://image.woshipm.com/wp-files/2019/07/pw3JXhjJCnB0jToR7070.png)

入侵防御系统入侵检测就是对发生在计算机系统或者网络上的事件进行监视、分析是否出现入侵的过程。

入侵防御系统按照检测目标环境可分为两类：网络型入侵检测系统和主机型入侵检测系统，二者可独立应用也可协同作战。

网络型入侵检测系统主要用于实时监控网络关键路径的信息，如同大楼内无处不在的电子监控系统，它采用旁路方式全面侦听网上信息流，动态监视网络上流过的所有数据包，进行检测和实时分析，从而实时甚至提前发现非法或异常行为，并且执行报警、阻断等功能，对事件的响应提供在线帮助，以最快的方式阻止入侵事件的发生。

并且能够全面的记录和管理日志，进行离线分析，对特殊事件提供智能判断和回放功能。

主机入侵检测系统是基于对主机的审计系统的信息进行监测，及时发现系统级用户的非法操作行为，可以用来实时监视可疑的连接、系统日志检查、非法访问的闯入等，并且提供对典型应用的监视，如Web服务器，电子邮件服务器等。

3.9.2.3 网络漏洞扫描系统

网络漏洞扫描系统的连接方式如上图（网络安全设备连接图）所示，该设备与核心交换机H3C 9500相连，其中NIC_1端口作为扫描端口，NIC_2端口作为网管端口。

![img](http://image.woshipm.com/wp-files/2019/07/Nfp4rZ4GHDhCvuBqmnMY.png)

网络漏洞扫描系统对整个网络进行安全扫描，以发现网络潜在的安全漏洞和薄弱环节，为整体的网络安全作出评估和测试。

另外，当网络的配置发生变化或者有其它的升级操作时，也应该进行同样的操作，防止网络发生变化时产生安全漏洞，给非法入侵者造成机会。

通常包括功能相对独立的三部分：

- 全面地扫描每个网络设备的安全漏洞并自动推荐合适的校正措施，呈现一张所有网络设备安全漏洞的全方位视图；
- 从操作系统的角度检测专用主机的整个安全性，允许管理员任意从远程自动更正分散网络上的安全漏洞；
- 通过网络快速、方便地扫描数据库，去检查数据库特有的安全漏洞，全面评估所有的安全漏洞和认证、授权、完整性方面的问题。

3.9.2.4 网络防病毒系统

网络防病毒系统部署在服务器（应用服务器）上。

网络防病毒系统能实现以下主要功能：

（1）网络防病毒集中管理和部署

- 强大、灵活的管理和任务调度手段，允许管理员通过中心控制台，集中地实现全网范围内防毒策略的定制、分发和执行；
- 管理员通过控制台，集中地实现所有节点上防毒软件的监控、配置、查询等管理工作；
- 病毒扫描引擎和代码库的更新，并能将此扫描引擎和代码库自动提供给各种服务器和工作站；
- 提供出色的事件报警、汇总、统计等辅助决策功能，可以随时对网络中病毒发生的情况进行查询统计，能按时间（日、周或任意时间段）、按IP地址、机器名、按病毒名称、病毒类型进行统计查询；使管理人员随时了解网络及病毒的宏观概况；
- 灵活的管理方式，可以支持集中和分布式管理，分布式管理可以跨越广域网，跨广域网时需要有效地利用带宽；
- 提供对手提电脑移动用户离开办公室后病毒防治的方案，包括病毒库的升级。

（2）网络防病毒处理能力

- 发现病毒后，有多种处理方法，例如清除、删除或隔离，以清除为主；采用伪指令技术，杀毒无需专杀工具。
- 支持邮件客户端防病毒，如：Outlook、foxmail邮件客户端；对SMTP、POP3进出邮件进程病毒监控；
- 全面监控所有病毒入口，对来自Internet、E-mail或是光盘、软盘移动存储、网络这些病毒入口，无论是宏病毒、特洛伊木马、黑客程序和有害程序全面进行实时监控；
- 支持查杀多种压缩格式的文件，同时不限压缩层数，能清除常见格式的压缩文件中的病毒。

（3）及时更新和响应

- 提供占用网络通讯流量最小的增量病毒定义码、引擎的更新升级方式；
- 提供多种方式的更新升级方法。

3.9.2.5 网页防篡改及恢复系统

网页防篡改及恢复软件系统部署在服务器（应用服务器）上。

网页防篡改及恢复系统能够完全保护网站不发送被篡改的页面，主要功能目标如下：

（1）动态网页脚本保护

采用核心内嵌技术的系统，可以直接从Web服务器上得到动态网页脚本，不受变化的内容影响，因而能够象静态网页一样保护动态网页脚本。

（2）连续篡改攻击保护

有意进行恶意攻击的黑客可以利用外挂轮询技术的扫描间隔来进行连续的篡改攻击，即在网页被恢复后立即重新篡改网页。而系统在每次输出网页时都进行完整性检查，如有变化则阻断发送。无论连续攻击多么迅速，保证不让公众看到被篡改的网页。

## 四、功能设计

### 4.1 功能总体设计

本平台可以分为门禁子系统、工程子系统、物业子系统、客户接口四个应用系统，门禁子系统、工程子系统又可再分app应用和管理后台网站。

门禁后台管理网站主要是管理员、运维人员使用，采用MVC三层架构，提供对账户、项目、小区、住户、员工、门禁、门卡等的管理。



**4.1.1 需求规定**



**4.1.2 基本设计**



4.1.2.2 系统功能模块图

![img](http://image.woshipm.com/wp-files/2019/07/onT5ALjvDWBYVNoQbQF4.png)

4.1.2.3 系统业务流程图

![img](http://image.woshipm.com/wp-files/2019/07/cJ9Sv4JjEPKoxgdPiPKx.png)

![img](http://image.woshipm.com/wp-files/2019/07/Itam9VzCKiRaUszEh12n.png)

4.1.2.4 用户接口设计

Internet用户在客户端IE地址栏输入站点URL“beiheng.suadi.com.cn”即可访问到首页。



### 4.2 工程建设协同管理子系统

**4.2.1 需求规定**

工程建设协同管理主要是对施工进行进度、质量、投资和安全的全过程管理，使得各参与方不仅能够全面了解施工状态、而且能够系统提升施工管理能力。

**4.2.2 基本设计**

4.2.2.1 子系统内容设计

子系统结构设计如下：

- 工程建设协同管理
- 质量管理
- 进度管理
- 安全管理
- 投资管理
- 风险管理
- 监测可视化
- 视频监控
- 信访管理
- 腾地管理
- 方案管理
- 管线搬迁

4.2.2.2 子系统功能模块图

![img](http://image.woshipm.com/wp-files/2019/07/iIsxT1RTUPcjg95Cw6mz.png)

4.2.2.3 页面效果设计描述

（1）质量管理：

质量分析主要以验收数据为依据，围绕部件、区域和时间展开分析，并给出结论和建议。系统将质量或检验报告与BIM信息模型相关联，可以实时查询任意WBS节点或施工段及构件的施工质量情况，并可自动生成工程质量统计分析报表，使相关人员能够对工程质量问题进行查看及处理回复。

1. 质量统计,对相应区段、时间段的质量通知单情况以图表形式进行统计并列出；
2. 质量报告,列举出详细的质量报告信息及内容，并能够在此模块中对质量报告与模型进行关联。

（2）进度管理：

进度分析利用WBS编辑器，完成施工段划分、WBS和进度计划创建，建立WBS与Microsoft Project的双向链接;通过BIM模型，对施工进度进行查询、调整和控制，使计划进度和实际进度既可以用甘特图表示，也可以以动态的3D图形展现出来，实现施工进度的4D动态管理;可提供任意WBS节点或3D施工段及构件工程信息的实时查询、计划与实际进度的追踪和分析等功能。

1. 进度查看，列出施工计划中各任务的计划时间、实际时间、工程量以及完成进度，并用甘特图的形式表示出来，用于查看详细的施工进度情况；
2. 计划维护，导入施工进度计划表，并能够对实际施工时间进行维护；
3. 进度报告，由施工单位每周进行实际施工进度的填报，内容包括每个构件的实际完成时间与实际工程量。

（3）安全管理：

安全分析主要以验收数据为依据，围绕部件、区域和时间展开分析，并给出结论和建议。系统将安全报告与BIM信息模型相关联，可以实时查询任意WBS节点或施工段及构件的施工安全情况，并可自动生成工程安全统计分析报表，使相关人员能够对工程安全问题进行查看及处理回复。

1. 安全统计，对相应区段、时间段的安全通知单情况以图表形式进行统计并列出；
2. 安全报告，列举出详细的安全报告信息及内容，并能够在此模块中对安全报告与模型进行关联。

（4）投资管理：

主要基于BIM模型自动生成工程量表，并可自动根据进度情况生成周、月、季度的工程量统计和指定时间段的工程量。并可以根据施工进度预测下一计算区间的工程量。

1. 分部分项清单，相关人员录入分部分项列表信息，通过与模型相关联的数据，展现各项各时间段的工程量；
2. 项目构件关联，相关人员录入模型构件与项目编码的关联表单，实现工程量与模型构件关联。

（5）风险管理：

平台通过设置风险判定规则或相关人员手动录入相关数据，针对不同风险源位置以及风险等级，标注相应的风险或安全标识；亦可实时展现工程风险状态分布；

相关人员也可以通过移动端拍照和定位功能，实现风险监察。

（6）监测可视化：

以BIM模型为基础，将施工方、监理方以及第三方监测数据与4D信息模型相关联，可以反映了当前工程安全状况（危险区域和预警区域）、实时查询任意施工段及周边环境的安全情况，并可进行预警信息自动推送。

1. 数据报表，能够对各个监测点的监测数据按时间维度进行查询，并生成分析图表。
2. 监测组，将同一个监测项目的多个监测点绑定成为一个监测组，能够同时对多个点的数据进行查看、分析与比较。

（7）视频监控：

平台通过与施工现场监控摄像头的数据对接，能够获取即时的监控图像，相关人员也能够控制摄像头的方向，实现通过平台即能观察施工现场的具体情况。

（8）信访管理：

将12345、投诉信箱等投诉渠道获得的针对工程各施工工地产生的投诉工单，根据来源、时间、工段、地区、类型进行分类统计并关联模型，形成分析图表，并且推送相关施工单位进行情况的核实与反馈，帮助指挥部对确实存在的问题进行监管与督促整改。

1. 信访统计分析，以图表形式显示各标段的信访工单数量以及处理情况，并能根据时间维导出信访工单的统计信息。同时列出最近的工单信息，方便相关人员对工单进行审核与回复；
2. 信访工单管理，将所有工单以及其信息以列表形式展现出来，并根据完成情况进行分类，相关人员能够对工单进行具体能容的查看并进行相关的处理操作。

（9）腾地管理：

平台通过相关人员录入的腾地相关信息，对工程的腾地情况进行整理汇总，包括腾地的地点、所属区属、长度、面积等。并与模型相关联，直观反映腾地的完成情况以及未完成的原因。

1. 统计报表，以图表形式表现腾地完成百分比与各区域完成情况，并列出近期需要完成的腾地项目；
2. 腾地列表，将腾地信息以列表形式表现，其中包含了腾地的所有信息；
3. 地点维护，相关人员能够对腾地信息进行录入、修改、删除等操作。

（10）方案管理：

平台通过相关人员提供的方案，基于模型对方案进行模拟，可用于方案的展示、研究与比选。

（11）管线管理：

平台通过相关人员提供的管线搬迁数据，基于模型对管线搬迁环境及方案进行模拟，可用于管线搬迁方案的展示、研究与比选。



## 五、接口设计

上海市地下空间设计研究总院系统是B/S结构的，它提供友好的浏览页面，利用HTTP协议交互与用户之间的操作指令、数据信息。用户各种操作都是通过浏览器来实现的，数据格式是以字符串的形式传到服务器，同时使用Ftp协议完成附件的上传和文件的下载。

### 5.1 用户接口



### 5.2 外部接口



### 5.3 内部接口

内部接口方面，各模块之间采用函数调用、参数传递、返回值的方式进行信息传递。具体参数的结构将在数据结构设计的内容中说明。接口传递的信息将是以数据结构封装了的数据，以参数传递或返回值的形式在各模块间传输。

## 六、运行设计

### 6.1 运行模块组合

客户端在有输入时启动接收数据模块，通过各模块之间的调用，读入并对输入进行格式化。

在接收数据模块得到充分的数据时，将调用网络传输模块，将数据通过网络送到服务器，并等待接收服务器返回的信息。接收到返回信息后随即调用数据输出模块，对信息进行处理，产生相应的输出。

服务器程序的接收网络数据模块必须始终处于活动状态。接收到数据后，调用数据处理/查询模块对数据库进行访问，完成后调用网络发送模块，将信息返回客户机。

### 6.2 运行控制

运行控制将严格按照各模块间函数调用关系来实现。在各事务中心模块中，需对运行控制进行正确的判断，选择正确的运行控制路径。

在网络传方面，客户端在发送数据后，将等待服务器的确认收到反馈，收到后，再次等待服务器发送回答数据，然后对数据进行确认。服务器在接到数据后发送确认信号，在对数据处理、访问数据库后，将返回信息送回客户端，并等待确认。

## 七、系统数据结构设计

### 7.1 逻辑结构设计要点

设计遵循的标准：

（1）表名定义标准:

类型：指定该表属于什么类型的哪一部分，长度是6。

描述：该表的简单描述，长度是8。

所有表名长度是14。

例如：

> prms_resourceprms

指该表是一个资源权限表。

（2）域名的定义标准：

> <Field data >_<Field one>

域的数据类别+域的描述

域的数据类型:特定的域数据类型,长度是1.

域的描述1该域的简单描述.

例如：

> prms_id

指该域名是资源权限类别ID.

（3）索引名定义标准：

> XK_<Table name >_<Other symbol>

X—用’X’表明该对象是一个索引.

索引类型:

- P：主键索引
- U：唯一的索引
- R：通常索引

表名描述：

最好用表明描述作为索引名的一部分。

其他字符：可以加域名描述或其他作为索引名的一部分。

### 7.2 部分数据结构

这部分是数据字典方面的内容，由于牵扯到数据的问题，在这里就不一一展示，就用一张表来作为案例：

![img](http://image.woshipm.com/wp-files/2019/07/Z1rVuAwu4o46uno3pazR.jpg)

### 7.3 数据结构与程序的关系

![img](http://image.woshipm.com/wp-files/2019/07/I7T9j0kWhB3ONaajoI5b.jpg)

## 八、容灾设计

### 8.1 出错情况

本设计要考虑的出错情况主要是指软件运行、系统部署时可能出现的异常,包括：

- 用户不规范的输入导致的程序错误；
- 系统运行时容器崩溃；
- 用户环境和开发时环境不一致造成的程序错误；
- 编码中的逻辑错误或者漏洞导致系统报错；

不包括由于硬件损伤、网络中断等情况的容错处理。

### 8.2 异常处理

本系统将采用如下的一般性设计原则减少程序和用户交互过程中可能出现的错误：

**（1）一致性**

- 菜单选择、数据显示以及其它功能都应使用一致的格式；
- 提供有意义的反馈信息；
- 执行有较大破坏性的动作前要求确认；
- 在数据录入上进行尽可能严格的合法性检测；
- 减少在动作间必须记忆的信息数量；
- 允许用户非恶意错误，系统应保护自己不受致命的破坏；
- 提供和运行环境相关的帮助机制。

**（2）本系统对于出错信息和警告应该遵循以下原则**

- 信息以用户可以理解的术语描述；
- 信息应提供如何从错误中恢复的建设性意见；
- 信息应指出错误可能导致哪些不良后果，以便用户检查是否出现了这些情况或帮助用户进行改正；
- 信息应伴随着视觉上的提示，如特殊的图像、颜色或信息闪烁；
- 信息不能带有判断色彩，即任何情况下不能指责用户。

系统采用统一的异常捕获和处理机制，为了便于团队开发的一致性，统一定义错误代码和友好显示信息。开发过程中根据具体情况可以扩展错误信息，制定更加详细的错误分类和信息显示。

为规范、统一各类系统错误或业务提示信息，统一定义公共信息列表。根据信息的性质与应用范围，将公共信息分类列表如下：

![img](http://image.woshipm.com/wp-files/2019/07/vsX7HBdjGGtd5gBwep1W.png)

### 8.3 补救措施

![img](http://image.woshipm.com/wp-files/2019/07/5yiAJSKx3nrfk0OdWFEp.png)

### 8.4 容灾备份

利用RAID5数据存储解决方案，实现实时数据备份,保障了系统的安全稳定运行。

### 8.5 系统维护设计

**8.5.1 设备运行维护**

- 设备运行维护指对网站群网络、服务器硬件设备、网络安全设备的运行管理维护，保证硬件设备正常运行。
- 设备运行维护由专业的硬件工程师进行，处理日常的设备管理、运行配置等操作。
- 设备运行维护按照设备操作手册与要求执行。

**8.5.2 应用系统运行维护**

主要负责对网站群所有应用系统软件的运行维护管理工作，一般由网站群系统管理员负责，处理应用系统日常数据维护、运行配置、软件应用异常处理等。

系统管理员将根据日志信息记录对系统进行维护处理。在该系统中，将规范统一系统日志管理，系统日志的信息级别分为一般信息、调试信息、警告信息、严重错误信息。

**8.5.3 系统安全与数据备份恢复维护**

由网站群系统安全管理员负责网络硬件、软件安全管理，同时，按照规范处理日常的数据备份工作，对系统安全异常情况，立即进行恢复应急处理。

日常数据备份内容一般包括数据库数据备份和网站用户上传的文件数据备份。

系统安全管理员严格按照安全管理制度进行日常管理工作。

**8.5.4 网站信息内容管理维护**

由专业的内容信息维护人员负责网站内容信息管理、策划，按照网站日常运行需求，策划网页内容建设。

## 结语

概要设计是一个将用户目标与需求转换成具体界面设计方案的重要阶段，在这里我们将要由前一阶段的需求分析得到软件（包括移动应用和网站等）的设计和数据结构。

概要设计通常是将复杂的系统按照不同的功能进行模块化，理清模块之间的层次关系以及调用关系、确定模块间的接口以及用户界面。而数据结构部分则是要根据数据的特征来确定数据的结构并设计出相应的数据库。